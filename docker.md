# Docker

### 도커 이미지와 컨테이너

도커 이미지

* 코드, 런타임, 시스템 도구, 시스템 라이브러리 및 설정과 같은 응용프로그램을 실행하는 데 필요한 모든 것을 포함하는 소프트웨어 패키지를 말한다.

도커 컨테이너

* 도커 이미지의 인스턴스이다.
* 응용프로그램을 실행한다.

***

### 도커 work flow

1. 도커 클라이언트가 도커 서버에 실행하고자 하는 이미지를 명령어 기반으로 전달한다.
2. 로 내 이미지 캐시 저장소에서 해당 이미지를 탐색한다.
3. 캐시 저장소에 실행하려는 이미지가 존재한다면 실행하고, 그렇지 않으면 도커 허브에서 이미지를 탐색해 캐시 저장소로 가져온 뒤 실행한다.

***

### 컨테이너 생성

* 도커 이미지는 사용하고자 하는 프로그램에 필요한 파일을 포함한다.
  * 스냅샷: 프로그램 설치에 필요한 파일
  * 실행 명령어: 스냅샷이 컨테이너에 적재된 뒤, 해당 프로그램을 실행하는 명령어

1. 도커 클라이언트 - docker run \[이미지명]
2. 도커 이미지에 있는 스냅샷을 컨테이너 HD에 적재한다.
3. run \[실행할 프로그램명] 명령어를 실행해준다.



### 도커 클라이언트 명령어

* docker run \[이미지명] \[명령어]
  * 명령어 자리가 비어 있지 않다면 이미지가 지니고 있는 시작 명령어를 무시하고 해당 명령어를 실행.
  * 이미지 내 존재하는 명령어만 사용할 수 있다.
* docker ps
  * 현재 실행 중인 컨테이너 목록 확인
  * \-a : 모든 컨테이너 목록 조회
* docker run \[이미지명] : docker create \[이미지명] + docker start \[컨테이너 아이디/이름]
  * docker create \[이미지명] : 컨테이너가 생성되면서 아이디를 출력한다.
  * docker start \[컨테이너 아이디/이름] : 컨테이너 실행
    * \-a :
* docker stop : 컨테이너가 하던 작업을 완료하고 중지시킨다.
  * SIGTERM(종료 신호) → SIGKILL(15) → Main process
* docker kill : 바로 컨테이너를 종료시킨다.
  * SIGKILL → Main process
* docker rm \[컨테이너 아이디/이름] : 컨테이너 삭제
  * 중지 상태의 컨테이너만 삭제할 수 있다.
  * docker rm ‘docker ps -a -q’ : 중지 상태 컨테이너 모두 삭제
* docker rmi \[이미지 ID] : 이미지 삭제
* docker system prune : 도커를 사용하지 않는 경우 컨테이너, 이미지, 네트워크 삭제
  * 중지 상태 컨테니어만 정리됨

